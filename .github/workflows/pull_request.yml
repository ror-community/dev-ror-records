name: Make sure new PRs are sent to staging
on:
  pull_request:
    types: [opened, edited, reopened]
    branches:
      - '!main'
      - '!v.**-rc'
      - 'staging'


jobs:
  print_context:
    runs-on: ubuntu-latest
    steps:
      - env:
          EVENT_CONTEXT: ${{ toJSON(github.event) }}
        run: |
          echo $EVENT_CONTEXT
  request:
    runs-on: ubuntu-latest
    steps:
    - name: Make Request
      id: myRequest
      env:
        USERNAME: ${{ secrets.USERNAME }}
      uses: fjogeleit/http-request-action@master
      with:
        url: "https://api.github.com/repos/ror-community/ror-records/collaborators/${env.USERNAME}/permission"
        customHeaders: "Authorization: token ${{ secrets.PERSONAL_ACCESS_TOKEN }}"
        method: 'GET'
    - name: Show Response
      run: echo ${{ steps.myRequest.outputs.response }}
